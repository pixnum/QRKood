<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>QRKood - QR Code Generator</title>
  <style>
    :root {
      --bg-light: #f9f9f9;
      --text-light: #222;
      --bg-dark: #121212;
      --text-dark: #eee;
      --primary-color: #007bff;
      --accent-color: #00c851;
      --error-color: #ff4444;
      --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      margin: 0;
      font-family: var(--font-family);
      background: var(--bg-light);
      color: var(--text-light);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      transition: background 0.3s, color 0.3s;
    }
    body[data-theme='dark'] {
      background: var(--bg-dark);
      color: var(--text-dark);
    }
    header {
      background: var(--primary-color);
      color: white;
      padding: 1rem;
      text-align: center;
      position: relative;
      user-select: none;
    }
    header h1 {
      margin: 0;
      font-weight: 700;
      font-size: 1.8rem;
    }
    .toggle-switch {
      position: absolute;
      top: 1rem;
      right: 1rem;
      width: 50px;
      height: 24px;
      display: inline-block;
    }
    .toggle-switch input {
      display: none;
    }
    .slider {
      position: relative;
      cursor: pointer;
      background-color: #ccc;
      border-radius: 24px;
      height: 100%;
      transition: background-color 0.3s;
    }
    .slider::before {
      content: "";
      position: absolute;
      height: 18px;
      width: 18px;
      left: 3px;
      top: 3px;
      background: white;
      border-radius: 50%;
      transition: transform 0.3s;
    }
    input:checked + .slider {
      background-color: var(--accent-color);
    }
    input:checked + .slider::before {
      transform: translateX(26px);
    }
    main {
      flex: 1 0 auto;
      max-width: 900px;
      margin: 1rem auto 2rem;
      padding: 0 1rem;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      align-items: center;
    }
    .controls, .options, .history-section, .bulk-section {
      width: 100%;
      max-width: 600px;
      background: #fff;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      box-shadow: 0 0 15px rgb(0 0 0 / 0.1);
      transition: background 0.3s, color 0.3s;
    }
    body[data-theme='dark'] .controls,
    body[data-theme='dark'] .options,
    body[data-theme='dark'] .history-section,
    body[data-theme='dark'] .bulk-section {
      background: #1e1e1e;
      color: var(--text-dark);
      box-shadow: 0 0 15px rgb(255 255 255 / 0.1);
    }
    label {
      display: block;
      margin-bottom: 0.3rem;
      font-weight: 600;
    }
    input[type="text"],
    input[type="email"],
    input[type="url"],
    input[type="tel"],
    input[type="number"],
    input[type="password"],
    input[type="datetime-local"],
    select,
    textarea {
      width: 100%;
      padding: 0.5rem;
      margin-bottom: 0.8rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
      resize: vertical;
      background: #fff;
      color: #222;
      transition: background 0.3s, color 0.3s, border-color 0.3s;
    }
    body[data-theme='dark'] input[type="text"],
    body[data-theme='dark'] input[type="email"],
    body[data-theme='dark'] input[type="url"],
    body[data-theme='dark'] input[type="tel"],
    body[data-theme='dark'] input[type="number"],
    body[data-theme='dark'] input[type="password"],
    body[data-theme='dark'] input[type="datetime-local"],
    body[data-theme='dark'] select,
    body[data-theme='dark'] textarea {
      background: #2c2c2c;
      color: var(--text-dark);
      border: 1px solid #555;
    }
    button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 5px;
      padding: 0.6rem 1.2rem;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s;
      margin-right: 0.5rem;
    }
    button:hover {
      background-color: var(--accent-color);
    }
    button:disabled {
      background-color: #999;
      cursor: not-allowed;
    }
    #qrcode-container {
      margin-top: 1rem;
      text-align: center;
      background: white;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 0 12px rgb(0 0 0 / 0.15);
      max-width: 320px;
    }
    body[data-theme='dark'] #qrcode-container {
      background: #222;
      box-shadow: 0 0 12px rgb(255 255 255 / 0.15);
    }
    #qrcode-container canvas {
      max-width: 100%;
      height: auto;
    }
    .history-section, .bulk-section {
      margin-top: 1rem;
    }
    #history-list div {
      cursor: pointer;
      padding: 0.4rem 0.6rem;
      border-bottom: 1px solid #ddd;
      font-size: 0.9rem;
      outline: none;
    }
    #history-list div:hover,
    #history-list div:focus {
      background-color: var(--accent-color);
      color: white;
    }
    body[data-theme='dark'] #history-list div {
      border-color: #444;
    }
    body[data-theme='dark'] #history-list div:hover,
    body[data-theme='dark'] #history-list div:focus {
      background-color: var(--accent-color);
      color: white;
    }
    #scanResult {
      margin-top: 0.8rem;
      font-weight: 600;
      min-height: 1.4rem;
      color: var(--accent-color);
      word-break: break-word;
    }
    #video {
      display: none;
      max-width: 100%;
      margin-top: 1rem;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.2);
    }
    @media (max-width: 600px) {
      main {
        padding: 0 0.5rem;
      }
      .controls, .options, .history-section, .bulk-section {
        max-width: 100%;
      }
      button {
        margin-bottom: 0.6rem;
        width: 100%;
      }
      button + button {
        margin-left: 0;
      }
    }
    footer {
      text-align: center;
      padding: 1rem;
      background: var(--primary-color);
      color: white;
      user-select: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>QRKood</h1>
    <label class="toggle-switch" aria-label="Toggle Dark Mode">
      <input type="checkbox" id="toggleTheme" />
      <span class="slider"></span>
    </label>
  </header>

  <main>
    <section class="controls" aria-label="QR Code data input controls">
      <label for="dataType">Select Data Type:</label>
      <select id="dataType" aria-describedby="dataTypeHelp">
        <option value="url">URL</option>
        <option value="text">Text</option>
        <option value="email">Email</option>
        <option value="phone">Phone</option>
        <option value="sms">SMS</option>
        <option value="wifi">Wi-Fi</option>
        <option value="vcard">vCard</option>
        <option value="geo">Geo Location</option>
        <option value="calendar">Calendar Event</option>
      </select>
      <small id="dataTypeHelp">Choose the type of data for your QR code</small>

      <div id="inputFields" style="margin-top: 1rem;"></div>

      <label for="password">Password (optional - encrypt data):</label>
      <input type="password" id="password" placeholder="Enter password to encrypt QR data" />

      <label for="size">Size (pixels):</label>
      <input type="number" id="size" min="100" max="1000" value="300" />

      <label for="ecLevel">Error Correction Level:</label>
      <select id="ecLevel">
        <option value="L">Low (7%)</option>
        <option value="M" selected>Medium (15%)</option>
        <option value="Q">Quartile (25%)</option>
        <option value="H">High (30%)</option>
      </select>

      <label for="fgColor">Foreground Color:</label>
      <input type="color" id="fgColor" value="#000000" />

      <label for="bgColor">Background Color:</label>
      <input type="color" id="bgColor" value="#ffffff" />

      <label for="logoFile">Logo/Image Overlay (optional):</label>
      <input type="file" id="logoFile" accept="image/*" />

      <button id="generateBtn" aria-label="Generate QR Code">Generate QR Code</button>
    </section>

    <section id="qrcode-container" aria-live="polite" aria-atomic="true" aria-label="Generated QR Code will appear here"></section>

    <section class="options" aria-label="Download options for QR Code">
      <button id="downloadPNG" aria-label="Download QR code as PNG">Download PNG</button>
      <button id="downloadJPEG" aria-label="Download QR code as JPEG">Download JPEG</button>
      <button id="downloadSVG" aria-label="Download QR code as SVG">Download SVG</button>
    </section>

    <section class="options" aria-label="Scan QR Code with device camera">
      <button id="scanBtn" aria-label="Scan QR code with camera">Scan QR Code with Camera</button>
      <video id="video" autoplay playsinline></video>
      <div id="scanResult" role="status" aria-live="polite"></div>
    </section>

    <section class="bulk-section" aria-label="Bulk QR code generation">
      <label for="bulkUpload">Bulk Generate from CSV (format: dataType,data):</label>
      <input type="file" id="bulkUpload" accept=".csv,text/csv" />
      <div id="bulkResults" style="margin-top: 1rem; display: flex; flex-wrap: wrap; justify-content: center;"></div>
    </section>

    <section class="history-section" aria-label="History of generated QR Codes">
      <h2>History (last 20 QR codes)</h2>
      <div id="history-list" tabindex="0" role="list" aria-live="polite" aria-atomic="true">
        No history yet.
      </div>
    </section>
  </main>

  <footer>
    <p>Â© Manik Roy 2025</p>
  </footer>

  <script>
    // QRious library embedded (minimized) or you can link externally here for simplicity
    // For demonstration, we will assume QRious is loaded externally
    // We'll use a CDN for QRious here
  </script>

  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const body = document.body;
      const toggleTheme = document.getElementById("toggleTheme");
      const dataType = document.getElementById("dataType");
      const inputFields = document.getElementById("inputFields");
      const sizeInput = document.getElementById("size");
      const generateBtn = document.getElementById("generateBtn");
      const qrcodeContainer = document.getElementById("qrcode-container");
      const ecLevelSelect = document.getElementById("ecLevel");
      const fgColorInput = document.getElementById("fgColor");
      const bgColorInput = document.getElementById("bgColor");
      const logoFileInput = document.getElementById("logoFile");
      const passwordInput = document.getElementById("password");
      const downloadPNGBtn = document.getElementById("downloadPNG");
      const downloadJPEGBtn = document.getElementById("downloadJPEG");
      const downloadSVGBtn = document.getElementById("downloadSVG");
      const scanBtn = document.getElementById("scanBtn");
      const video = document.getElementById("video");
      const scanResult = document.getElementById("scanResult");
      const bulkUpload = document.getElementById("bulkUpload");
      const bulkResults = document.getElementById("bulkResults");
      const historyList = document.getElementById("history-list");

      let qr; // QRious instance
      let currentLogoImg = null;

      // Initialize theme toggle based on system preference
      if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){
        toggleTheme.checked = true;
        body.setAttribute('data-theme','dark');
      }
      toggleTheme.addEventListener('change', () => {
        if(toggleTheme.checked){
          body.setAttribute('data-theme','dark');
        } else {
          body.setAttribute('data-theme','light');
        }
      });

      // Render dynamic inputs based on data type
      function renderInputs(type){
        switch(type){
          case "url":
            inputFields.innerHTML = `
              <label for="urlInput">URL</label>
              <input type="url" id="urlInput" placeholder="https://example.com" />`;
            break;
          case "text":
            inputFields.innerHTML = `
              <label for="textInput">Text</label>
              <textarea id="textInput" rows="4" placeholder="Enter text here"></textarea>`;
            break;
          case "email":
            inputFields.innerHTML = `
              <label for="emailInput">Email</label>
              <input type="email" id="emailInput" placeholder="user@example.com" />`;
            break;
          case "phone":
            inputFields.innerHTML = `
              <label for="phoneInput">Phone Number</label>
              <input type="tel" id="phoneInput" placeholder="+1234567890" />`;
            break;
          case "sms":
            inputFields.innerHTML = `
              <label for="smsPhone">Phone Number</label>
              <input type="tel" id="smsPhone" placeholder="+1234567890" />
              <label for="smsMsg">Message</label>
              <textarea id="smsMsg" rows="2" placeholder="Your SMS message"></textarea>`;
            break;
          case "wifi":
            inputFields.innerHTML = `
              <label for="wifiSSID">SSID</label>
              <input type="text" id="wifiSSID" placeholder="Network Name" />
              <label for="wifiType">Encryption</label>
              <select id="wifiType">
                <option value="WPA">WPA/WPA2</option>
                <option value="WEP">WEP</option>
                <option value="nopass">None</option>
              </select>
              <label for="wifiPassword">Password</label>
              <input type="password" id="wifiPassword" placeholder="Password" />`;
            break;
          case "vcard":
            inputFields.innerHTML = `
              <label for="vcardName">Full Name</label>
              <input type="text" id="vcardName" placeholder="John Doe" />
              <label for="vcardOrg">Organization</label>
              <input type="text" id="vcardOrg" placeholder="Company Inc." />
              <label for="vcardTitle">Title</label>
              <input type="text" id="vcardTitle" placeholder="Job Title" />
              <label for="vcardEmail">Email</label>
              <input type="email" id="vcardEmail" placeholder="email@example.com" />
              <label for="vcardPhone">Phone</label>
              <input type="tel" id="vcardPhone" placeholder="+1234567890" />`;
            break;
          case "geo":
            inputFields.innerHTML = `
              <label for="geoLat">Latitude</label>
              <input type="number" id="geoLat" placeholder="37.4220" step="any" />
              <label for="geoLng">Longitude</label>
              <input type="number" id="geoLng" placeholder="-122.0841" step="any" />`;
            break;
          case "calendar":
            inputFields.innerHTML = `
              <label for="calSummary">Event Summary</label>
              <input type="text" id="calSummary" placeholder="Meeting with Team" />
              <label for="calStart">Start Date & Time</label>
              <input type="datetime-local" id="calStart" />
              <label for="calEnd">End Date & Time</label>
              <input type="datetime-local" id="calEnd" />
              <label for="calLocation">Location</label>
              <input type="text" id="calLocation" placeholder="Meeting Room" />`;
            break;
          default:
            inputFields.innerHTML = `
              <label for="defaultInput">Data</label>
              <textarea id="defaultInput" rows="3" placeholder="Enter data"></textarea>`;
        }
      }
      renderInputs(dataType.value);
      dataType.addEventListener('change', () => {
        renderInputs(dataType.value);
      });

      // Build QR content based on data type and input values
      function buildQRContent(){
        let value = "";
        const pw = passwordInput.value.trim();
        function encrypt(text){
          if(!pw) return text;
          return CryptoJS.AES.encrypt(text, pw).toString();
        }
        switch(dataType.value){
          case "url":
            {
              const url = document.getElementById("urlInput").value.trim();
              value = url;
            }
            break;
          case "text":
            {
              const txt = document.getElementById("textInput").value.trim();
              value = txt;
            }
            break;
          case "email":
            {
              const email = document.getElementById("emailInput").value.trim();
              value = `mailto:${email}`;
            }
            break;
          case "phone":
            {
              const phone = document.getElementById("phoneInput").value.trim();
              value = `tel:${phone}`;
            }
            break;
          case "sms":
            {
              const phone = document.getElementById("smsPhone").value.trim();
              const msg = document.getElementById("smsMsg").value.trim();
              value = `SMSTO:${phone}:${msg}`;
            }
            break;
          case "wifi":
            {
              const ssid = document.getElementById("wifiSSID").value.trim();
              const type = document.getElementById("wifiType").value;
              const password = document.getElementById("wifiPassword").value.trim();
              // Format: WIFI:T:WPA;S:mynetwork;P:mypass;;
              value = `WIFI:T:${type};S:${ssid};P:${password};;`;
            }
            break;
          case "vcard":
            {
              const name = document.getElementById("vcardName").value.trim();
              const org = document.getElementById("vcardOrg").value.trim();
              const title = document.getElementById("vcardTitle").value.trim();
              const email = document.getElementById("vcardEmail").value.trim();
              const phone = document.getElementById("vcardPhone").value.trim();
              value = `BEGIN:VCARD\nVERSION:3.0\nFN:${name}\nORG:${org}\nTITLE:${title}\nEMAIL:${email}\nTEL:${phone}\nEND:VCARD`;
            }
            break;
          case "geo":
            {
              const lat = document.getElementById("geoLat").value.trim();
              const lng = document.getElementById("geoLng").value.trim();
              value = `geo:${lat},${lng}`;
            }
            break;
          case "calendar":
            {
              const summary = document.getElementById("calSummary").value.trim();
              const start = document.getElementById("calStart").value.trim();
              const end = document.getElementById("calEnd").value.trim();
              const location = document.getElementById("calLocation").value.trim();
              if(!summary || !start){
                alert("Event summary and start time are required.");
                return null;
              }
              const dtStart = start.replace(/-|:|\.\d+/g, '');
              const dtEnd = end ? end.replace(/-|:|\.\d+/g, '') : dtStart;
              value =
                `BEGIN:VEVENT\nSUMMARY:${summary}\nDTSTART:${dtStart}\nDTEND:${dtEnd}\nLOCATION:${location}\nEND:VEVENT`;
            }
            break;
          default:
            {
              const def = document.getElementById("defaultInput");
              value = def ? def.value.trim() : "";
            }
        }
        if(!value){
          alert("Please enter valid data.");
          return null;
        }
        if(passwordInput.value.trim()){
          value = encrypt(value);
        }
        return value;
      }

      function drawQRCode(){
        const content = buildQRContent();
        if(!content) return;
        const size = parseInt(sizeInput.value, 10) || 300;
        const ecLevel = ecLevelSelect.value || 'M';
        const fg = fgColorInput.value || '#000000';
        const bg = bgColorInput.value || '#ffffff';

        // Clear previous
        qrcodeContainer.innerHTML = "";

        qr = new QRious({
          value: content,
          size: size,
          level: ecLevel,
          background: bg,
          foreground: fg,
        });

        // Draw QR to canvas
        const canvas = qr.canvas;

        if(logoFileInput.files.length > 0){
          const file = logoFileInput.files[0];
          const ctx = canvas.getContext('2d');
          const img = new Image();
          img.onload = () => {
            const scale = 0.2; // logo size relative to qr
            const w = canvas.width * scale;
            const h = canvas.height * scale;
            const x = (canvas.width - w) / 2;
            const y = (canvas.height - h) / 2;
            ctx.drawImage(img, x, y, w, h);
            qrcodeContainer.appendChild(canvas);
            saveHistory(content, canvas.toDataURL());
          };
          const reader = new FileReader();
          reader.onload = e => {
            img.src = e.target.result;
          };
          reader.readAsDataURL(file);
        } else {
          qrcodeContainer.appendChild(canvas);
          saveHistory(content, canvas.toDataURL());
        }
      }

      generateBtn.addEventListener('click', drawQRCode);

      // Download functions
      function downloadCanvas(format){
        if(!qr) return;
        const canvas = qr.canvas;
        const link = document.createElement('a');
        if(format === 'svg'){
          // QRious can export svg as string
          const svgStr = qr.toDataURL().replace(/^data:image\/png;base64,/, '');
          // But QRious does not have direct svg export, so fallback to PNG for now
          alert('SVG export is not supported directly. Downloading PNG instead.');
          link.href = canvas.toDataURL("image/png");
          link.download = 'QRKood.png';
          link.click();
          return;
        }
        if(format === 'png'){
          link.href = canvas.toDataURL("image/png");
          link.download = 'QRKood.png';
        } else if(format === 'jpeg'){
          link.href = canvas.toDataURL("image/jpeg");
          link.download = 'QRKood.jpg';
        }
        link.click();
      }

      downloadPNGBtn.addEventListener('click', () => downloadCanvas('png'));
      downloadJPEGBtn.addEventListener('click', () => downloadCanvas('jpeg'));
      downloadSVGBtn.addEventListener('click', () => downloadCanvas('svg'));

      // History (store last 20 in localStorage)
      function saveHistory(data, imgData){
        let history = JSON.parse(localStorage.getItem('qrkoodHistory') || '[]');
        history.unshift({data, imgData, date: Date.now()});
        if(history.length > 20) history.pop();
        localStorage.setItem('qrkoodHistory', JSON.stringify(history));
        renderHistory();
      }
      function renderHistory(){
        let history = JSON.parse(localStorage.getItem('qrkoodHistory') || '[]');
        if(history.length === 0){
          historyList.innerHTML = "No history yet.";
          return;
        }
        historyList.innerHTML = "";
        history.forEach((item, idx) => {
          const div = document.createElement('div');
          div.tabIndex = 0;
          div.role = "listitem";
          div.title = item.data;
          div.textContent = item.data.length > 40 ? item.data.substring(0,37) + "..." : item.data;
          div.addEventListener('click', () => {
            passwordInput.value = "";
            // Load this QR code into main canvas
            qr = new QRious({
              value: item.data,
              size: parseInt(sizeInput.value, 10) || 300,
              level: ecLevelSelect.value || 'M',
              background: bgColorInput.value || '#ffffff',
              foreground: fgColorInput.value || '#000000',
            });
            qrcodeContainer.innerHTML = "";
            qrcodeContainer.appendChild(qr.canvas);
          });
          historyList.appendChild(div);
        });
      }

      renderHistory();

      // QR Scan feature
      let scanning = false;
      let stream;
      let jsQRScriptLoaded = false;

      scanBtn.addEventListener('click', () => {
        if(scanning){
          stopScan();
        } else {
          startScan();
        }
      });

      function startScan(){
        scanResult.textContent = "Starting camera...";
        navigator.mediaDevices.getUserMedia({video: {facingMode: "environment"}}).then(s => {
          stream = s;
          video.srcObject = stream;
          video.setAttribute("playsinline", true);
          video.style.display = "block";
          scanning = true;
          scanBtn.textContent = "Stop Scanning";
          scanFrame();
        }).catch(err => {
          alert("Camera access denied or not available.");
          scanResult.textContent = "";
        });
      }

      function stopScan(){
        scanning = false;
        scanBtn.textContent = "Scan QR Code with Camera";
        scanResult.textContent = "";
        video.style.display = "none";
        if(stream){
          stream.getTracks().forEach(track => track.stop());
        }
      }

      function loadJsQRScript(){
        return new Promise((resolve, reject) => {
          if(jsQRScriptLoaded) resolve();
          const script = document.createElement('script');
          script.src = "https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js";
          script.onload = () => {
            jsQRScriptLoaded = true;
            resolve();
          };
          script.onerror = () => reject(new Error("Failed to load jsQR library"));
          document.head.appendChild(script);
        });
      }

      async function scanFrame(){
        if(!scanning) return;
        if(!jsQRScriptLoaded){
          try{
            await loadJsQRScript();
          } catch(e){
            alert(e.message);
            stopScan();
            return;
          }
        }
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const code = jsQR(imageData.data, imageData.width, imageData.height, {
          inversionAttempts: "dontInvert",
        });
        if(code){
          scanResult.textContent = "QR Code Content: " + code.data;
          stopScan();
        } else {
          requestAnimationFrame(scanFrame);
        }
      }

      // Bulk CSV upload parsing and generation
      bulkUpload.addEventListener('change', e => {
        const file = e.target.files[0];
        if(!file) return;
        const reader = new FileReader();
        reader.onload = evt => {
          bulkResults.innerHTML = "";
          const lines = evt.target.result.split(/\r?\n/).filter(l=>l.trim());
          lines.forEach((line, idx) => {
            // Format: dataType,data
            const parts = line.split(",");
            if(parts.length < 2){
              bulkResults.innerHTML += `<p style="color: var(--error-color);">Line ${idx+1}: Invalid format.</p>`;
              return;
            }
            const bulkType = parts[0].trim();
            const bulkData = parts.slice(1).join(",").trim();
            try {
              const bulkQr = new QRious({
                value: bulkData,
                size: 200,
                level: "M",
              });
              const img = document.createElement('img');
              img.src = bulkQr.toDataURL();
              img.alt = `QR Code for ${bulkData}`;
              img.style.margin = "8px";
              img.title = bulkData;
              bulkResults.appendChild(img);
            } catch(e){
              bulkResults.innerHTML += `<p style="color: var(--error-color);">Line ${idx+1}: Error generating QR code.</p>`;
            }
          });
        };
        reader.readAsText(file);
      });

    });
  </script>
</body>
</html>
